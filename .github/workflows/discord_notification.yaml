name: discord-notification

on:
  pull_request:
    branches:
      - stg
      - develop
  push:
    branches:
      - develop  # developブランチへのプッシュ時のみトリガー

jobs:
  notify:
    name: Notify Discord
    runs-on: ubuntu-20.04
    steps:
      - name: Discord Notification
        uses: sarisia/actions-status-discord@v1
        if: always() # 常に通知を送る
        with:
          webhook: ${{ secrets.DISCORD_WEBHOOK }}
          name: Discord Notification
          title: ${{ github.event.pull_request.title || 'No Title' }}
          description: |
            Pull Request: ${{ github.event.pull_request.html_url || 'No URL' }}
            Author: ${{ github.event.pull_request.user.login || 'Unknown Author' }}

  develop_push_notify:
    name: Notify Discord for develop push
    runs-on: ubuntu-20.04
    if: github.ref == 'refs/heads/develop'  # developブランチへのプッシュ時のみ実行
    steps:
      - name: Discord Notification
        uses: sarisia/actions-status-discord@v1
        if: always() # 常に通知を送る
        with:
          webhook: ${{ secrets.WORKING_TO_DEVELOP_WEBHOOK }}
          name: Discord Notification
          title: ${{ github.event.head_commit.message || 'No Commit Message' }}
          description: |
            Commit: ${{ github.event.head_commit.url || 'No URL' }}
            Author: ${{ github.event.head_commit.author.name || 'Unknown Author' }}
